<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>A2 Arena de Escolhas</title>
<style>
  body { font-family: Arial, sans-serif; background-color: #111; color: #eee; text-align: center; position: relative;}
  #arena { margin-top: 30px; border: 2px solid #555; padding: 20px; display: inline-block; background-color: #222; position: relative;}
  .btn { padding: 10px 20px; margin: 10px; cursor: pointer; background-color: #222; color: #fff; border: 1px solid #555; }
  .btn:hover { background-color: #333; }
  #log { margin-top: 20px; min-height: 120px; max-width: 600px; margin-left: auto; margin-right: auto; text-align: left; }
  #healthBar, #enemyHealthBar { width: 300px; height: 25px; background-color: #555; margin: 10px auto; border: 1px solid #333; }
  #health, #enemyHealth { width: 100%; height: 100%; background-color: #4CAF50; transition: width 0.2s; }
  #images { margin-top: 20px; }
  #images img { width: 150px; margin: 0 20px; border: 3px solid transparent; transition: border 0.2s; }
  @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.3); } 100% { transform: scale(1); } }
</style>
</head>
<body>

<h1>A2 Arena de Escolhas</h1>

<div id="arena">
  <p><strong>Vida de A2:</strong></p>
  <div id="healthBar"><div id="health"></div></div>
  
  <p><strong>Vida do Inimigo:</strong></p>
  <div id="enemyHealthBar"><div id="enemyHealth"></div></div>

  <p><strong>Escolha sua ação:</strong></p>
  <button class="btn" onclick="playerAttack()">Atacar</button>
  <button class="btn" onclick="playerDefend()">Defender</button>
  <button class="btn" onclick="playerSpecial()">Ataque Especial</button>
  <button class="btn" onclick="restartGame()">Recomeçar</button>
</div>

<div id="images">
  <img id="playerImg" src="placeholder_a2.png" alt="A2">
  <img id="enemyImg" src="placeholder_enemy.png" alt="Inimigo">
</div>

<div id="log"></div>

<script>
let playerHealth = 100;
let enemyHealth = 100;
let gameOver = false;
let easterEggsFound = { special:false, attack:false, defend:false };
let specialMode = window.location.search.includes('special=true');

const log = document.getElementById('log');
const playerImg = document.getElementById('playerImg');
const enemyImg = document.getElementById('enemyImg');
const healthBar = document.getElementById('health');
const enemyHealthBar = document.getElementById('enemyHealth');

function updateHealth() {
  healthBar.style.width = playerHealth + '%';
  enemyHealthBar.style.width = enemyHealth + '%';
}

function logMessage(msg, color='white') {
  log.innerHTML = `<p style="color:${color}">${msg}</p>` + log.innerHTML;
}

function flashBorder(img, color) {
  img.style.border = `3px solid ${color}`;
  setTimeout(() => { img.style.border = '3px solid transparent'; }, 300);
}

function playSound(file) {
  const audio = new Audio(`sounds/${file}`);
  audio.play();
}

function easterEgg(action) {
  if (gameOver) return;
  let chance = Math.random();
  let icon = '';
  if (action === 'special' && chance < 0.5) { icon = '<img src="images/a2_icon.png" style="width:32px; vertical-align:middle; animation: pulse 0.5s;">'; easterEggsFound.special = true; }
  else if (action === 'attack' && chance < 0.3) { icon = '<img src="images/transformer_icon.png" style="width:32px; vertical-align:middle; animation: pulse 0.5s;">'; easterEggsFound.attack = true; }
  else if (action === 'defend' && chance < 0.2) { icon = '<img src="images/magic_icon.png" style="width:32px; vertical-align:middle; animation: pulse 0.5s;">'; easterEggsFound.defend = true; }
  if (icon) logMessage(`Easter Egg! ${icon}`, 'cyan');
}

function triggerVictoryCutscene() {
  const arena = document.getElementById('arena');
  let originalBg = arena.style.backgroundColor;
  arena.style.backgroundColor = '#444';
  let flashes = 0;
  const interval = setInterval(() => {
    playerImg.style.border = playerImg.style.border === '3px solid gold' ? '3px solid transparent' : '3px solid gold';
    flashes++;
    if (flashes > 5) { clearInterval(interval); playerImg.style.border = '3px solid transparent'; arena.style.backgroundColor = originalBg; logMessage('🎉 Todos os Easter Eggs desbloqueados! Parabéns! 🎉', 'pink'); showFigureReward(); }
  }, 300);
}

function triggerSpecialEnding() {
  if (!specialMode) return;
  const arena = document.getElementById('arena');
  let originalBg = arena.style.backgroundColor;
  arena.style.backgroundColor = '#FFD700';
  logMessage('✨ Final Secreto Desbloqueado! Feliz aniversário! ❤️ ✨', 'pink');
  let flashes = 0;
  const interval = setInterval(() => {
    playerImg.style.border = playerImg.style.border === '3px solid pink' ? '3px solid transparent' : '3px solid pink';
    flashes++;
    if (flashes > 6) { clearInterval(interval); playerImg.style.border = '3px solid transparent'; arena.style.backgroundColor = originalBg; showFigureReward(); }
  }, 300);
}

// Recompensa física da figure
function showFigureReward() {
  const arena = document.getElementById('arena');
  const rewardMessage = document.createElement('div');
  
  rewardMessage.id = 'figureReward';
  rewardMessage.style.position = 'absolute';
  rewardMessage.style.top = '50%';
  rewardMessage.style.left = '50%';
  rewardMessage.style.transform = 'translate(-50%, -50%)';
  rewardMessage.style.backgroundColor = 'rgba(0,0,0,0.9)';
  rewardMessage.style.color = 'gold';
  rewardMessage.style.padding = '30px';
  rewardMessage.style.border = '3px solid #FFD700';
  rewardMessage.style.borderRadius = '20px';
  rewardMessage.style.fontSize = '1.5em';
  rewardMessage.style.textAlign = 'center';
  rewardMessage.style.zIndex = '1000';
  rewardMessage.innerHTML = `
    🎉 Parabéns! Você venceu a Arena! 🎉<br><br>
    Sua recompensa: <strong>A2 está aqui para você!</strong><br>
    💛 Abra seu presente físico agora! 💛
  `;
  
  document.body.appendChild(rewardMessage);

  setTimeout(() => {
    rewardMessage.style.transition = 'opacity 2s';
    rewardMessage.style.opacity = '0';
    setTimeout(() => rewardMessage.remove(), 2000);
  }, 4000);
}

// Ações do jogo
function enemyAttack() {
  if (gameOver) return;
  const enemies = ['Invasor Digital', 'TransformBot', 'Digitmon'];
  const dmg = Math.floor(Math.random() * 15) + 5;
  playerHealth -= dmg;
  if (playerHealth < 0) playerHealth = 0;
  updateHealth();
  playSound('hit.mp3');
  logMessage(`${enemies[Math.floor(Math.random()*enemies.length)]} atacou A2 causando ${dmg} de dano!`);
  flashBorder(enemyImg, 'red');
  checkEnd();
}

function playerAttack() {
  if (gameOver) return;
  playSound('attack.mp3');
  const dmg = Math.floor(Math.random() * 15) + 5;
  enemyHealth -= dmg;
  if (enemyHealth < 0) enemyHealth = 0;
  updateHealth();
  logMessage(`A2 atacou causando ${dmg} de dano!`);
  flashBorder(playerImg, 'red');
  easterEgg('attack');
  checkEnemy();
}

function playerDefend() {
  if (gameOver) return;
  playSound('defend.mp3');
  logMessage(`A2 se defendeu! O próximo ataque do inimigo será mais fraco.`, 'blue');
  flashBorder(playerImg, 'blue');
  easterEgg('defend');
  setTimeout(enemyAttack, 500);
}

function playerSpecial() {
  if (gameOver) return;
  playSound('special.mp3');
  const dmg = Math.floor(Math.random() * 25) + 10;
  enemyHealth -= dmg;
  if (enemyHealth < 0) enemyHealth = 0;
  updateHealth();
  logMessage(`A2 usou Ataque Especial causando ${dmg} de dano!`, 'gold');
  flashBorder(playerImg, 'gold');
  easterEgg('special');
  checkEnemy();
}

function checkEnemy() {
  if (enemyHealth <= 0) {
    enemyHealth = 0;
    updateHealth();
    gameOver = true;
    playSound('victory.mp3');
    logMessage(`Inimigo derrotado! Você venceu a Arena! 🌟`, 'lime');
    logMessage(`Mensagem especial: “Você salvou o dia e descobriu todos os easter eggs!” 💌`, 'pink');
    playerImg.src = 'placeholder_victory.png';
    enemyImg.src = 'placeholder_enemy_defeated.png';
    if (easterEggsFound.special && easterEggsFound.attack && easterEggsFound.defend) triggerVictoryCutscene();
    if (specialMode && easterEggsFound.special && easterEggsFound.attack && easterEggsFound.defend) triggerSpecialEnding();
  } else { setTimeout(enemyAttack, 500); }
}

function checkEnd() {
  if (playerHealth <= 0) {
    playerHealth = 0;
    updateHealth();
    gameOver = true;
    playSound('defeat.mp3');
    logMessage(`A2 foi derrotada… 😢`, 'red');
    playerImg.src = 'placeholder_defeat.png';
    enemyImg.src = 'placeholder_enemy_victory.png';
  }
}

function restartGame() {
  gameOver = false;
  playerHealth = 100;
  enemyHealth = 100;
  easterEggsFound = { special:false, attack:false, defend:false };
  updateHealth();
  log.innerHTML = '';
  playerImg.src = 'placeholder_a2.png';
  enemyImg.src = 'placeholder_enemy.png';
}

updateHealth();
</script>

</body>
</html>
